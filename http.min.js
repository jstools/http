/*! jstool-http 2014-12-06 */
!function(a){"use strict";if("undefined"!=typeof window)if(window.fn)fn.define("http",["Promise",a]);else{if("undefined"==typeof Promise)throw"Promise is required for http to be defined";window.http=a(Promise)}}(function(a){"use strict";function b(b,c){if(c||(c=b instanceof Object?b:{}),c.url&&(b=c.url),!b)return!1;c.method||(c.method="GET"),c.contentType||(c.contentType=/^json$/i.test(c.mode)?"application/json":"application/x-www-form-urlencoded"),/^json$/i.test(c.mode)&&isObject(c.data)&&(c.data=JSON.stringify(c.data));var d=null;try{d=new XMLHttpRequest}catch(e){try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){d=new ActiveXObject("Microsoft.XMLHTTP")}}if(null===d)throw"Browser does not support HTTP Request";var f=new a(function(a,e){if(d.open(c.method,b,void 0===c.async?!0:c.async),d.onreadystatechange=function(){if("complete"==d.readyState||4==d.readyState)if(d.status>=200&&d.status<300){var b=/^json$/i.test(c.mode)?JSON.parse(d.responseText):/^xml$/i.test(c.mode)?d.responseXML:d.responseText;a(b,d.status,d)}else{var b=/^json$/i.test(c.mode)?JSON.parse(d.responseText):/^xml$/i.test(c.mode)?d.responseXML:d.responseText;e(b,d.status,d)}},d.setRequestHeader("Content-Type",c.contentType),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.headers)for(var f in c.headers)d.setRequestHeader(f,c.headers[f]);d.send(c.data)});return f.request=d,f}return b});