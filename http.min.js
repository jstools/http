/*! jstool-http 2015-01-22 */
!function(a){"use strict";if("undefined"!=typeof window){if("undefined"==typeof Promise)throw"Promise is required for http to be defined";window.fn?fn.define("http",a):"undefined"!=typeof Promise&&(window.http=a())}}(function(){"use strict";function a(){for(var a,b=[],c=b.shift.call(arguments),d=b.shift.call(arguments);d;){for(a in d)c[a]=d[a];d=b.shift.call(arguments)}return c}function b(a){var b=a[0].toUpperCase()+a.substr(1);return b.replace(/([a-z])([A-Z])/,function(a,b,c){return b+"-"+c})}function c(a){var b=a[0].toLowerCase()+a.substr(1);return b.replace(/([a-z])-([A-Z])/,function(a,b,c){return b+c})}function d(e,f){e instanceof Object&&(f=e,e=f.url),f=f||{};var g,h=a({},d.defaults);for(g in f)f[g]instanceof Function&&(f[g]=f[g]()),h[g]instanceof Function&&(h[g]=h[g]()),f[g]instanceof Object?a(h[g],f[g]):h[g]=f[g];if(!e)throw"url missing";var i=null;try{i=new XMLHttpRequest}catch(j){try{i=new ActiveXObject("Msxml2.XMLHTTP")}catch(j){i=new ActiveXObject("Microsoft.XMLHTTP")}}if(null===i)throw"Browser does not support HTTP Request";var k={},l=new Promise(function(a,d){i.open(h.method,e,void 0===h.async?!0:h.async),i.onreadystatechange=function(){if("complete"==i.readyState||4==i.readyState){i.headers={},i.getAllResponseHeaders().replace(/\s*([^\:]+)\s*\:\s*([^\n]+)\s*\n/g,function(a,b,d){i.headers[c(b)]=d});var b=i.responseText;"application/json"===i.headers.contentType&&(b=JSON.parse(b)),k[i.status]?k[i.status].apply(i,[b,a,d]):i.status>=200&&i.status<300?a(b,i.status,i):d(b,i.status,i)}};for(g in h.headers)i.setRequestHeader(b(g),h.headers[g]);i.send(h.data)});return l.request=i,l.success=l.then,l.error=l.catch,l.complete=l.finally,l.catchResponse=function(a,b){"string"==typeof a&&b instanceof Function&&(k[a]=b)},l}return d.defaults={method:"get",headers:{contentType:"application/json"}},d.get=d,["head","options","post","patch","put","delete"].forEach(function(a){d[a]=function(b,c){return b instanceof Object&&(c=b,b=c.url),c=c||{},c.method=a.toUpperCase(),d(b,c)}}),d});